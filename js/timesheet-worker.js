function start(){function z(){$("input").on("focus",function(){setTimeout(function(){$(this).select()},10);var c=$(this).closest("td");c.css("position","relative");var b=c.attr("id"),f=p[b],d="";if(b=x(b)){var r=f.taskType;"time"==f.cellType?b[r]?(f=e.get("timesheet-rounding")?e.get("timesheet-rounding-mode")||0:null,d=e.get("timesheet-limiting-mode")?1:0,d=minutesForTotals(b[r],f,d).toString(),d=d.toString().replace(".",v)):d="0":"count"==f.cellType&&(d=b[r]?b[r].count:"0")}$(".ra-value").remove();
$span=$(document.createElement("span")).addClass("ra-value").css("position","absolute").css("font-size","10px").css("left","3px").css("top","2px").text(d);c.append($span)});$("input").on("blur",function(){$(".ra-value").remove()})}function A(c){chrome.runtime.sendMessage({method:"fetch-greater-month"},function(b){console.log("Fetched "+Object.keys(b.sessions).length+" session(s)");if(b.error)c(null,b.error);else{b.active&&(b.sessions[b.active.sid]=b.active);var f={},d;for(d in b.sessions){var e=b.sessions[d],
g=new Date(e.start),a=g.getFullYear(),n=g.getMonth()+1,g=g.getDate();f[a]||(f[a]={});f[a][n]||(f[a][n]={});f[a][n][g]||(f[a][n][g]={exp:{count:0,duration:0,allotted:0},sxs:{count:0,duration:0,allotted:0},rr:{count:0,duration:0,allotted:0}});var a=f[a][n][g],h;for(h in e.types){var n=e.types[h][0],g=e.types[h][1],m=e.types[h][2];h=h.toLowerCase();0==h.indexOf("sxs")?(a.sxs.duration+=m,a.sxs.allotted+=g,a.sxs.count+=n):0==h.indexOf("rr")?(a.rr.duration+=m,a.rr.allotted+=g,a.rr.count+=n):0==h.indexOf("irr")?
(a.irr.duration+=m,a.irr.allotted+=g,a.irr.count+=n):(a.exp.duration+=m,a.exp.allotted+=g,a.exp.count+=n)}}c(f)}})}function B(c){function b(b){function d(a){a=a.children("td");var b=a.eq(0).text().toLowerCase();a.each(function(a){if(2<=a&&15>=a){var c=e[Math.floor((a-2)/2)],d=$(this).attr("id");if(!d||!c)return!1;g[d]={id:d,date:c,cellType:0==a%2?"time":"count",taskType:b}}else 16==a&&(a=$(this).find("input").val())&&a.match(",..$")&&(v=",")})}var e=[];b.find("th").each(function(a){var b=$(this).text();
if(a=/(Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday) (\d+)\/(\d+)\/(\d+)/.exec(b)){var b=parseInt(a[2],10),c=parseInt(a[3],10);a=parseInt(a[4],10);2E3<=b?e.push({year:b,month:c,date:a}):e.push({year:a,month:b,date:c})}else(a=/(Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday) (\d+)\.(\d+)\.(\d+)/.exec(b))?e.push({year:parseInt(a[4],10),month:parseInt(a[3],10),date:parseInt(a[2],10)}):(a=/(Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday) (\d+)-(\d+)-(\d+)/.exec(b))&&e.push({year:parseInt(a[4],
10),month:parseInt(a[2],10),date:parseInt(a[3],10)})});var g={};b.find("tr").each(function(a){19==$(this).children("td").length&&d($(this))});c(g)}$("td").each(function(){if(-1!=$(this).text().indexOf("EXPERIMENTAL TASK"))return b($(this).closest("table")),!1})}function x(c){var b=p[c].date.year,e=p[c].date.month;c=p[c].date.date;var d=null;try{d=q[b][e][c]}catch(k){}return d}function k(c){if(e.get(atob("c3Vic2NyaXB0aW9u"))){A(function(b,d){d?console.log("Error in performFetch: "+d):(q=b,B(function(b,
d){if(d)console.log("Error in processCells: "+d);else{p=b;z();var a=e.get("timesheet-rounding")?e.get("timesheet-rounding-mode")||0:null,f=e.get("timesheet-limiting-mode")?1:0,h;for(h in p){var m=$("#"+h);m.removeClass("ra-red ra-yellow ra-green");var k=m.find("input").eq(0),w=parseFloat(k.val().replace(",",".")),l=x(h),u=p[h].taskType;if(l&&l[u]&&l[u].count){var q=p[h].cellType;"count"==q?(l=l[u].count,w==l?m.addClass("ra-green"):m.addClass("ra-yellow"),c&&(k.val(l),k.click())):"time"==q&&(l=minutesForTotals(l[u],
a,f),w==l?m.addClass("ra-green"):m.addClass("ra-yellow"),c&&(l=l.toString().replace(".",v),k.val(l).click()))}else 0!=w&&(m.addClass("ra-red"),c&&k.val(0).click())}c&&$("input").blur()}}))});$("#ra-autofill").remove();var b=$('span:contains("Save Timesheet")').closest("span.urTbarItmBtn");b.length&&(b.closest("td").append('<span id="ra-autofill" class="urTbarItmBtn"><a id="ra-autofill-link" class="urNoUserSelect urBtnRadius urBtnStdValign urBtnStdWithImg urBtnStd" style="text-align:center;overflow:visible"><img id="ra-autofill-icon" border="0" align="absmiddle" style="margin-top:0"></img>&nbsp;<span class="urBtnCntTxt">Fill Timesheet</span></a></span>'),
$("#ra-autofill-icon").attr("src","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAYAAAAfSC3RAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2tpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wUmlnaHRzPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvcmlnaHRzLyIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcFJpZ2h0czpNYXJrZWQ9IkZhbHNlIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjVFNDZBQzg0NEM5QjExRTVCOEEwRTUxODI2MTdFMzk0IiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjVFNDZBQzgzNEM5QjExRTVCOEEwRTUxODI2MTdFMzk0IiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDUzMgTWFjaW50b3NoIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InV1aWQ6MzkwMUQ4RjIwRTM2RTMxMTgzMERDMzdBOTk3NUNGQjYiIHN0UmVmOmRvY3VtZW50SUQ9InV1aWQ6QUNCOTE1OUJFRTM0RTMxMTgzMERDMzdBOTk3NUNGQjYiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7yoXb7AAAB70lEQVR42mJkQAfZmy0Z+MTiGTgFtIE8RobvH68zfHq5lGGq7wFkZYwomuqv7mWQ0HBiwAZe3jrM8PSSC8Ps8F+oGtufPGbgFZMBMdO1mRjMxSFSJ1/+Z5h59R9Ezbf3rxnOr5VmWJ71mwUsUH3pEAOXsAzD379gbpw6M4OVJBOYrS7wj2HmJYg4AzufKIOa02kgy4CJIXG5AYOQoi3Dnz8MMHzx1V+4Q8BsJDkGPml9huTVziwMPOL5DL9/M8TpsDFYSkEc4CLHDNfoCmRPd2QFs48/+8Ow6ArQi9xiGSwMrDzaIJMiNLgZPJXZMMJERZAJiNnBbHk+RoZFF74xMLBwyjMx/P3DyPDnN8OvP/8YCAGwGqBaoEWMLAxf3t9k4JE2OXD3OwMr43+wAgNJNgYpXohzn33+y3DhOTgGGA7c/cHA8Bvoz2+fnjAyhMw2Y1B2Ools8oxAEYZ0cz4we+bJTwwZ69+gWn3vkDcTw5rUUwyv754GBRAM64qzwtWA2UhyDO8eXWdYnbgNEozPL1sCA+kFMJ5EQNxFp94z3Hz5E5IAHn6DRAPYk18/Mjw6aYGacpybOBgkDQ8y8MuZYQ2ZT0/PM7y85Mawq+INZloFAa/JnsBUFMnAyqkElv/9/QHDt7erGbblbkBWBhBgABLPtdyc+rl5AAAAAElFTkSuQmCC"))}}
var e={initialize:function(c){chrome.storage.local.get(null,function(b){e._prefs=b;c&&c()});chrome.storage.onChanged.addListener(function(b,c){if("local"==c){for(var d in b)e._prefs[d]=b[d].newValue;for(d in b)if(e._monitors[d])e._monitors[d](e._prefs[d])}})},get:function(c){return e._prefs[c]},set:function(c,b,f){if(null!==c&&"undefined"!==typeof c)if(null!==b&&"undefined"!==typeof b){var d={};d[c]=b;chrome.storage.local.set(d,f);e._prefs[c]=b}else chrome.storage.local.remove(c,f),delete e._prefs[c]},
monitor:function(c,b){e._monitors[c]=b},_prefs:{},_monitors:{}};if($("#start_Timesheet").length)window.location=$("#start_Timesheet").attr("href");else{var y=document.body.textContent;if((-1!=y.indexOf("EXPERIMENTAL TASK")||-1!=y.indexOf("SIDE BY SIDE TASK"))&&!$("td").eq(0).attr("data-busy")){$("td").eq(0).attr("data-busy","true");$("head").append("<style> td.ra-red{background-color:pink !important} td.ra-yellow{background-color:yellow !important} td.ra-green{background-color:lightgreen !important} </style>");
var p,q,v=".";chrome.runtime.onMessage.addListener(function(c){"refresh"==c.type&&k(!1)});$(document).on("mousedown","a",function(){"ra-autofill-link"==$(this).attr("id")?k(!0):(setTimeout(k,500),setTimeout(k,1E3))});e.monitor("timesheet-rounding",function(){k()});e.monitor("timesheet-limiting-mode",function(){k()});e.monitor("timesheet-rounding-mode",function(){k()});e.initialize(k)}}}
var t=setInterval(function(){$("table").length&&(clearInterval(t),start());document.title="RA Timesheet Assistant"},100);
